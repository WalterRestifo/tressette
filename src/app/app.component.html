@if(isGameOver){
<app-end-game-screen [winner]="winner" />
} @else if (!isGameInitialised) {
<app-initial-screen />
} @else {
<div>
  <div>
    <div class="relative w-full h-[70dvh]">
      <img
        ngSrc="/img/wooden-desk.png"
        width="1920"
        height="1080"
        class="absolute top-0 left-0 w-full h-full object-cover"
        alt="Wooden desk background"
        priority
      />
      @if (isOwnTurn) {
      <h2 class="text-white text-center py-8 text-4xl">It's your turn</h2>
      } @else {
      <h2 class="text-white text-center py-8 text-4xl">
        It's the turn of {{ currentPlayerName }}
      </h2>
      } @if (fromOpponentLastDrawnCard ){
      <div
        class="flex flex-col items-center"
        id="opponents-last-drawn-card"
        animate.enter="slide-from-top"
      >
        <h3 class="text-white">Opponents last drawn card</h3>
        <div>
          <app-deck-single-card
            [data]="fromOpponentLastDrawnCard"
            [player]="player!"
            [leadingSuit]="leadingSuit"
            [isDisabled]="true"
          />
        </div>
      </div>
      } @else {
      <app-placeholder-card />
      }

      <div class="flex items-center justify-around">
        @if(card1) {
        <div
          class="flex flex-col items-center"
          [animate.enter]="animation1"
          animate.leave="slide-out"
        >
          <h3 class="text-white">Player 1</h3>

          <app-deck-single-card
            [data]="card1"
            [player]="player!"
            [leadingSuit]="leadingSuit"
          />
        </div>
        } @else {
        <app-placeholder-card />
        } @if(card2){
        <div
          class="flex flex-col items-center"
          [animate.enter]="animation2"
          animate.leave="slide-out"
        >
          <h3 class="text-white">Player 2</h3>
          <app-deck-single-card
            [data]="card2"
            [player]="player!"
            [leadingSuit]="leadingSuit"
          />
        </div>
        } @else {
        <app-placeholder-card />
        }
        <div class="w-[9vw] aspect-2/3" #deckRef>
          <div
            class="w-[92%] h-full bg-cover bg-center rounded-sm"
            [style.backgroundImage]="'url(img/card_back.png)'"
          ></div>
        </div>
      </div>
    </div>
    <div>
      <div class="flex justify-between my-4 items-center">
        <span class="text-white mx-4" id="points"
          >Your points: {{ player!.points / 3 | number : "1.1-1" }}</span
        >
        <button
          matButton="elevated"
          class="mx-4"
          id="quit-btn"
          (click)="endGame()"
        >
          quit game
        </button>
      </div>
      <ul class="list-none flex flex-wrap justify-around">
        @for(card of hand; track card.id){
        <li class="mx-1 perspective-normal w-[9vw] aspect-2/3">
          <div
            class="w-full h-full relative [transform-style:preserve-3d] [transform:rotateY(180deg)]"
            #handCardImageRef
          >
            <div
              class="absolute w-full h-full [backface-visibility:hidden] [transform:rotateY(180deg)]"
            >
              <app-deck-single-card
                [data]="card"
                [player]="player!"
                [leadingSuit]="leadingSuit"
                [currentPlayerName]="currentPlayerName"
              />
            </div>

            <div
              class="absolute w-[95%] h-full [backface-visibility:hidden] bg-cover bg-center rounded-sm"
              [style.backgroundImage]="'url(img/card_back.png)'"
            ></div>
          </div>
        </li>
        }
      </ul>
    </div>
  </div>
</div>
}

<router-outlet />
